{
    "json_schemas": {
      "description": "JSON representations",
      
      "user_schema": {
        "description": "User entity",
        "example": {
          "user_id": 1,
          "phone_number": "+250795963036",
          "full_name": "Account Holder",
          "account_type": "individual",
          "momo_account_id": "36521838",
          "current_balance": 980.00,
          "created_at": "2024-05-01T08:30:00Z",
          "updated_at": "2024-05-25T19:50:55Z"
        },
        "sql_mapping": {
          "table": "users",
          "direct_fields": ["user_id", "phone_number", "full_name", "account_type", "momo_account_id", "current_balance", "created_at", "updated_at"]
        }
      },
  
      "transaction_category_schema": {
        "description": "Transaction category entity",
        "example": {
          "category_id": 1,
          "category_name": "Individual Payment",
          "category_type": "payment",
          "description": "Payment to named individual with account ID",
          "created_at": "2024-05-01T00:00:00Z"
        },
        "sql_mapping": {
          "table": "transaction_categories",
          "direct_fields": ["category_id", "category_name", "category_type", "description", "created_at"]
        }
      },
  
      "transaction_schema": {
        "description": "Core transaction entity with essential SMS data",
        "example": {
          "transaction_id": 1,
          "sms_date": 1715351458724,
          "readable_date": "10 May 2024 4:30:58 PM",
          "external_ref_id": "76662021700",
          "amount": 2000.00,
          "currency": "RWF",
          "transaction_fee": 0.00,
          "new_balance": 2000.00,
          "transaction_datetime": "2024-05-10T16:30:51Z",
          "status": "completed",
          "sms_body": "You have received 2000 RWF from Jane Smith (*********013) on your mobile money account at 2024-05-10 16:30:51. Message from sender: . Your new balance:2000 RWF. Financial Transaction Id: 76662021700.",
          "sender": {
            "user_id": null,
            "full_name": "Jane Smith"
          },
          "receiver": {
            "user_id": 1,
            "phone_number": "+250795963036",
            "full_name": "Account Holder"
          },
          "category": {
            "category_id": 2,
            "category_name": "Money Transfer",
            "category_type": "transfer"
          },
          "created_at": "2024-05-10T16:30:58Z"
        },
        "sql_mapping": {
          "table": "transactions",
          "joins": [
            "LEFT JOIN users sender ON transactions.sender_id = sender.user_id",
            "LEFT JOIN users receiver ON transactions.receiver_id = receiver.user_id",
            "JOIN transaction_categories ON transactions.category_id = transaction_categories.category_id"
          ]
        }
      },
  
      "user_transaction_history_schema": {
        "description": "Junction table for many-to-many relationship",
        "example": {
          "history_id": 1,
          "user_id": 1,
          "transaction_id": 1,
          "role_type": "receiver",
          "created_at": "2024-05-10T16:30:58Z"
        },
        "sql_mapping": {
          "table": "user_transaction_history",
          "direct_fields": ["history_id", "user_id", "transaction_id", "role_type", "created_at"]
        }
      },
  
      "system_log_schema": {
        "description": "System processing logs",
        "example": {
          "log_id": 1,
          "log_type": "info",
          "process_name": "xml_parser",
          "message": "Successfully processed XML file with 5 transactions",
          "transaction_ref": null,
          "created_at": "2024-05-10T16:35:00Z"
        },
        "sql_mapping": {
          "table": "system_logs",
          "direct_fields": ["log_id", "log_type", "process_name", "message", "transaction_ref", "created_at"]
        }
      },
  
      "api_response_examples": {
        "description": "Sample API responses",
        
        "transaction_list_response": {
          "example": {
            "status": "success",
            "data": {
              "transactions": [
                {
                  "transaction_id": 1,
                  "external_ref_id": "76662021700",
                  "amount": 2000.00,
                  "currency": "RWF",
                  "transaction_datetime": "2024-05-10T16:30:51Z",
                  "sender_name": "Jane Smith",
                  "receiver_name": "Account Holder",
                  "category": "Money Transfer",
                  "status": "completed"
                },
                {
                  "transaction_id": 2,
                  "external_ref_id": "73214484437",
                  "amount": 1000.00,
                  "currency": "RWF",
                  "transaction_datetime": "2024-05-10T16:31:39Z",
                  "sender_name": "Account Holder",
                  "receiver_name": "Jane Smith",
                  "category": "Individual Payment",
                  "status": "completed"
                }
              ],
              "total_count": 5,
              "total_amount": 46600.00
            }
          }
        },
  
        "user_summary_response": {
          "example": {
            "status": "success",
            "data": {
              "user": {
                "user_id": 1,
                "phone_number": "+250795963036",
                "full_name": "Account Holder",
                "account_type": "individual",
                "current_balance": 980.00
              },
              "transaction_summary": {
                "total_sent": 44600.00,
                "total_received": 42000.00,
                "sent_count": 4,
                "received_count": 1,
                "total_fees_paid": 320.00
              }
            }
          }
        },
  
        "category_analysis_response": {
          "example": {
            "status": "success",
            "data": {
              "categories": [
                {
                  "category_name": "Individual Payment",
                  "category_type": "payment",
                  "transaction_count": 1,
                  "total_amount": 1000.00,
                  "percentage": 2.15
                },
                {
                  "category_name": "Money Transfer", 
                  "category_type": "transfer",
                  "transaction_count": 1,
                  "total_amount": 2000.00,
                  "percentage": 4.29
                },
                {
                  "category_name": "Bank Deposit",
                  "category_type": "deposit", 
                  "transaction_count": 1,
                  "total_amount": 40000.00,
                  "percentage": 85.84
                },
                {
                  "category_name": "Airtime Purchase",
                  "category_type": "airtime",
                  "transaction_count": 1,
                  "total_amount": 2000.00,
                  "percentage": 4.29
                }
              ],
              "total_transactions": 5,
              "total_volume": 46600.00
            }
          }
        }
      },
  
      "data_mapping_documentation": {
        "description": "How SQL data maps to JSON for API responses",
        "mapping_rules": {
          "direct_mapping": "Most fields map 1:1 from SQL columns to JSON properties",
          "nested_objects": "Related entities (sender, receiver, category) are embedded as objects",
          "computed_fields": "Aggregated data like totals and counts are calculated in queries",
          "null_handling": "SQL NULL values become JSON null, empty strings remain empty strings"
        },
        "sms_data_extraction": {
          "xml_to_sql": {
            "date": "Convert XML timestamp to BIGINT in sms_date field",
            "body": "Store complete SMS text in sms_body field", 
            "readable_date": "Store human-readable date string",
            "amount": "Extract from SMS body using regex patterns",
            "txid": "Extract transaction ID from SMS body",
            "recipient": "Extract recipient name and phone/account from SMS body"
          },
          "sql_to_json": {
            "sms_date": "Convert BIGINT timestamp back to ISO 8601 string for API",
            "sms_body": "Include full SMS text for audit trail",
            "parsed_fields": "Include extracted amounts, names, IDs as separate fields"
          }
        }
      }
    }
  }